spec:
  namePrefix: hotrod-cypress-demo
  runnerGroup: cypress
  script: |
    #!/bin/bash
    set -e

    # Clone the git repo
    echo "Cloning signadot repo"
    git clone --single-branch -b "@{branch}" \
      https://github.com/Emminex23/hotrod_.git

    # Run the cypress demo test
    cd hotrod_

    export CYPRESS_HOTROD_NAMESPACE="@{namespace}"
    export CI=true

    npm ci
    set +e
    npx cypress run
    set -e

  routingContext:
    sandbox: "@{sandbox}"
  uploadArtifact:
    - path: hotrod/cypress/videos/hotrod-demo.cy.js.mp4
